# 音频测试指南

## 🎯 测试目标

确保 FlowMind 的所有音频功能正常工作，包括：
- 环境白噪音的循环播放
- 完成提示音的触发
- 长休息提醒音的触发
- 音量控制和淡入淡出效果
- 音频切换的平滑过渡

## 🚀 测试前准备

### 1. 启动应用
```bash
cd /Users/tangyuan/Documents/augment-projects/FlowMind
npm run dev
```

### 2. 打开浏览器
访问 `http://localhost:3000/`

### 3. 准备测试环境
- 确保电脑音量适中（建议 50%）
- 准备耳机或音箱
- 打开浏览器开发者工具（F12）查看控制台错误

## 📋 测试清单

### 一、环境白噪音测试（Ambient Sounds）

#### 测试步骤：

1. **打开设置**
   - 点击右下角的设置图标 ⚙️
   - 找到"音效设置"部分

2. **测试每个环境音**

   **测试项 1: 雨声 (Rain)**
   - [ ] 在"环境音"下拉菜单选择"雨声 (Rain)"
   - [ ] 点击"保存"
   - [ ] 点击播放按钮 ▶️
   - [ ] 验证：听到雨声，音频循环播放
   - [ ] 验证：音频淡入效果（约1秒）
   - [ ] 调节音量滑块，验证音量变化平滑

   **测试项 2: 森林 (Forest)**
   - [ ] 切换到"森林 (Forest)"
   - [ ] 验证：音频平滑切换（旧音频淡出，新音频淡入）
   - [ ] 验证：听到鸟鸣和森林环境音

   **测试项 3: 咖啡店 (Cafe)**
   - [ ] 切换到"咖啡店 (Cafe)"
   - [ ] 验证：听到咖啡馆氛围音（人声、杯碟声）

   **测试项 4: 壁炉 (Fireplace)**
   - [ ] 切换到"壁炉 (Fireplace)"
   - [ ] 验证：听到火焰噼啪声

   **测试项 5: 海洋 (Ocean)**
   - [ ] 切换到"海洋 (Ocean)"
   - [ ] 验证：听到海浪声，节奏规律

   **测试项 6: 风铃 (Wind Chimes)**
   - [ ] 切换到"风铃 (Wind Chimes)"
   - [ ] 验证：听到清脆的风铃声

   **测试项 7: 白噪音 (White Noise)**
   - [ ] 切换到"白噪音 (White Noise)"
   - [ ] 验证：听到均匀的白噪音

   **测试项 8: 图书馆 (Library)**
   - [ ] 切换到"图书馆 (Library)"
   - [ ] 验证：听到安静的图书馆氛围音

   **测试项 9: 无声 (None)**
   - [ ] 切换到"无声 (None)"
   - [ ] 验证：音频停止播放，淡出效果正常

3. **测试音量控制**
   - [ ] 将音量调到 0%，验证静音
   - [ ] 将音量调到 50%，验证中等音量
   - [ ] 将音量调到 100%，验证最大音量
   - [ ] 在播放中调节音量，验证平滑过渡（300ms）

4. **测试播放/暂停**
   - [ ] 点击暂停按钮 ⏸，验证音频淡出并停止
   - [ ] 点击播放按钮 ▶️，验证音频淡入并继续
   - [ ] 使用空格键暂停/播放，验证快捷键功能

### 二、完成提示音测试（Completion Sounds）

#### 测试步骤：

1. **启用完成提示音**
   - [ ] 打开设置 ⚙️
   - [ ] 找到"完成提示音"开关
   - [ ] 勾选启用

2. **测试颂钵 (Singing Bowl)**
   - [ ] 选择"颂钵 (Singing Bowl)"
   - [ ] 将专注时间设置为 1 分钟（方便测试）
   - [ ] 点击保存并开始计时
   - [ ] 等待 1 分钟
   - [ ] 验证：计时结束时听到颂钵声
   - [ ] 验证：音频只播放一次，不循环

3. **测试竹风铃 (Bamboo Chime)**
   - [ ] 在设置中选择"竹风铃 (Bamboo Chime)"
   - [ ] 重复上述测试流程
   - [ ] 验证：听到清脆的竹风铃声

4. **测试音乐盒 (Music Box)**
   - [ ] 在设置中选择"音乐盒 (Music Box)"
   - [ ] 重复上述测试流程
   - [ ] 验证：听到柔和的音乐盒旋律

5. **测试开关功能**
   - [ ] 取消勾选"完成提示音"
   - [ ] 完成一个番茄钟
   - [ ] 验证：计时结束时没有提示音

### 三、长休息提醒音测试（Reminder Sounds）

#### 测试步骤：

1. **配置测试环境**
   - [ ] 打开设置 ⚙️
   - [ ] 将"专注时间"设置为 1 分钟
   - [ ] 将"短休息"设置为 1 分钟
   - [ ] 将"每轮会话数"设置为 2（即 2 个专注后长休息）
   - [ ] 启用"长休息提醒音"

2. **测试摇铃 (Bell)**
   - [ ] 选择"摇铃 (Bell)"
   - [ ] 点击保存
   - [ ] 完成第 1 个专注（1分钟）
   - [ ] 完成第 1 个休息（1分钟）
   - [ ] **关键时刻**：第 2 个专注开始时
   - [ ] 验证：听到摇铃提醒音
   - [ ] 验证：提示"下一个休息是长休息"

3. **测试钢琴 (Piano)**
   - [ ] 在设置中选择"钢琴 (Piano)"
   - [ ] 重复上述测试流程
   - [ ] 验证：在第 2 个专注开始时听到钢琴声

4. **测试开关功能**
   - [ ] 取消勾选"长休息提醒音"
   - [ ] 重复测试流程
   - [ ] 验证：第 2 个专注开始时没有提醒音

### 四、综合场景测试

#### 场景 1: 完整工作流程
- [ ] 设置：专注 25 分钟，休息 5 分钟，每 4 轮长休息 15 分钟
- [ ] 选择环境音：雨声
- [ ] 启用完成提示音：颂钵
- [ ] 启用长休息提醒音：摇铃
- [ ] 开始计时并验证整个流程

#### 场景 2: 快速切换测试
- [ ] 在播放环境音时快速切换不同音频
- [ ] 验证：切换平滑，无卡顿或杂音
- [ ] 验证：音量保持一致

#### 场景 3: 跨模式测试
- [ ] 从专注模式切换到休息模式
- [ ] 验证：环境音继续播放
- [ ] 验证：完成提示音正常触发
- [ ] 使用"跳过"按钮快速切换
- [ ] 验证：音频状态正确

#### 场景 4: 浏览器兼容性测试
- [ ] Chrome 浏览器测试
- [ ] Safari 浏览器测试
- [ ] Firefox 浏览器测试
- [ ] Edge 浏览器测试

## 🐛 常见问题排查

### 问题 1: 音频无法播放
**可能原因**：
- 浏览器自动播放策略限制
- 音频文件路径错误
- 文件格式不支持

**排查步骤**：
1. 打开浏览器控制台（F12）
2. 查看是否有错误信息
3. 检查 Network 标签，确认音频文件加载成功
4. 尝试手动点击播放按钮（用户交互后可播放）

### 问题 2: 音频卡顿或延迟
**可能原因**：
- 网络加载慢
- 文件过大
- 浏览器性能问题

**排查步骤**：
1. 检查音频文件大小
2. 查看 Network 标签的加载时间
3. 尝试预加载音频

### 问题 3: 音频切换不平滑
**可能原因**：
- 淡入淡出时间设置不当
- 音频切换逻辑问题

**排查步骤**：
1. 检查 `fadeAudio` 函数的参数
2. 确认淡入淡出时长（建议 500-1000ms）

### 问题 4: 音量控制无效
**可能原因**：
- 音频元素未正确绑定
- 音量值未正确传递

**排查步骤**：
1. 在控制台输入 `audioRef.current.volume` 查看当前音量
2. 检查音量滑块的 onChange 事件

## ✅ 测试通过标准

### 必须通过的测试
- ✅ 所有 8 个环境音都能正常播放和循环
- ✅ 音频切换平滑，有淡入淡出效果
- ✅ 音量控制响应灵敏，调节平滑
- ✅ 完成提示音在正确时机触发
- ✅ 长休息提醒音在正确时机触发
- ✅ 播放/暂停功能正常
- ✅ 无控制台错误

### 建议通过的测试
- ✅ 在主流浏览器中都能正常工作
- ✅ 音频加载时间 < 2 秒
- ✅ 音频切换延迟 < 500ms
- ✅ 无明显的音频质量问题

## 📊 测试报告模板

```markdown
## 音频功能测试报告

**测试日期**: YYYY-MM-DD
**测试人员**: [姓名]
**浏览器**: [Chrome/Safari/Firefox/Edge] [版本号]
**操作系统**: [macOS/Windows/Linux] [版本号]

### 测试结果总览
- 环境音测试: ✅ 通过 / ❌ 未通过
- 完成提示音测试: ✅ 通过 / ❌ 未通过
- 长休息提醒音测试: ✅ 通过 / ❌ 未通过
- 综合场景测试: ✅ 通过 / ❌ 未通过

### 发现的问题
1. [问题描述]
   - 严重程度: 高/中/低
   - 复现步骤: [详细步骤]
   - 预期结果: [描述]
   - 实际结果: [描述]

### 改进建议
1. [建议内容]

### 总体评价
[整体评价和结论]
```

---

**测试完成后，请将测试报告提交给开发团队！** 🎉

