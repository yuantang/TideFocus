# FlowMind - 心流番茄钟产品文档

## 📋 产品概述

**FlowMind** (Gentle Focus Timer) 是一款极简、舒缓的番茄钟应用，专为需要专注学习或工作的用户设计。产品灵感来源于流行的"study-with-me"视频，采用柔和的视觉设计和环境白噪音，特别适合对刺激敏感的用户。

### 核心定位
- **目标用户**: 学生、知识工作者、需要长时间专注的人群
- **使用场景**: 学习、工作、阅读、写作等需要深度专注的场景
- **产品理念**: "A Gentle Place to Focus" - 一个温柔的专注空间

---

## 🎯 核心功能

### 1. 番茄钟计时系统

#### 1.1 三种计时模式
- **专注模式 (Focus)**: 默认 25 分钟，用于深度工作
- **短休息 (Short Break)**: 默认 5 分钟，用于快速恢复
- **长休息 (Long Break)**: 默认 15 分钟，用于深度放松

#### 1.2 智能轮次管理
- 可配置每轮专注次数（默认 4 次）
- 完成一轮后自动触发长休息
- 长休息时显示随机励志名言
- 支持禁用长休息功能（设置为 0）

#### 1.3 计时器控制
- **播放/暂停**: 空格键或点击按钮
- **跳过当前阶段**: 右箭头键或点击"Next"按钮
- 自动切换模式（专注→休息→专注）
- 动态页面标题显示剩余时间

### 2. 视觉设计系统

#### 2.1 分屏布局
- **专注/短休息模式**: 左右分屏显示，当前模式高亮，非活动模式半透明
- **长休息模式**: 全屏沉浸式体验，显示励志名言

#### 2.2 主题配色
内置 4 套预设主题：
1. **Rose (玫瑰)**: 默认主题，温暖的粉色调
2. **Forest (森林)**: 清新的绿色调
3. **Sky (天空)**: 宁静的蓝色调
4. **Dusk (黄昏)**: 深色模式，适合夜间使用

#### 2.3 自定义配色
- 支持自定义专注、短休息、长休息的背景色和文字色
- 实时预览配色效果
- 一键重置为默认主题

#### 2.4 视觉反馈
- 圆形进度条动画
- 呼吸动画效果（活动状态）
- 平滑的颜色过渡（500ms）
- 图标状态变化（专注、休息、长休息）

### 3. 音频系统 🎵

FlowMind 的音频系统经过精心设计，所有音频文件均来自高质量的 BetterSleep 音频库，确保最佳的听觉体验。

#### 3.1 环境白噪音（Ambient Sounds）

**8 种精选背景音效**，循环播放，营造舒适的工作氛围：

| 音频 | 中文名 | 适用场景 | 特点 |
|------|--------|----------|------|
| None | 无声 | 需要完全安静 | 关闭所有背景音 |
| Rain | 雨声 | 专注学习、阅读 | 经典白噪音，屏蔽环境杂音 |
| Forest | 森林 | 放松、冥想 | 自然鸟鸣，舒缓心情 |
| Cafe | 咖啡店 | 工作、写作 | 人声氛围，模拟咖啡馆环境 |
| Fireplace | 壁炉 | 冬季学习、夜间工作 | 温暖舒适，噼啪声 |
| Ocean | 海洋 | 深度专注、放松 | 海浪声，平静规律 |
| Wind Chimes | 风铃 | 轻度工作、休息 | 轻柔悦耳，不干扰思考 |
| White Noise | 白噪音 | 需要完全屏蔽外界声音 | 纯白噪音，最强屏蔽效果 |
| Library | 图书馆 | 学习、考试准备 | 安静氛围，偶尔翻书声 |

**音频特性**：
- ✅ **循环播放**: 无缝循环，不会中断
- ✅ **智能淡入淡出**: 1秒淡入，避免突兀（播放时）；500ms淡出（暂停/切换时）
- ✅ **实时音量调节**: 0-100% 平滑调节，300ms 过渡
- ✅ **音频预览**: 在设置界面可以预览每个音频，点击播放按钮试听
- ✅ **预加载技术**: 自动预加载音频文件，减少播放延迟
- ✅ **错误处理**: 加载失败时显示友好提示，可重试
- ✅ **本地存储**: 所有音频文件存储在本地，加载速度快

**音频文件格式**: OGG Vorbis（开源、高压缩率、音质优秀）

#### 3.2 完成提示音（Completion Sounds）

**3 种温柔的提示音**，在每个番茄钟结束时播放：

| 音频 | 中文名 | 特点 |
|------|--------|------|
| None | 无声 | 关闭提示音 |
| Singing Bowl | 颂钵 | 温柔悠长，禅意十足（默认） |
| Bamboo Chime | 竹风铃 | 清脆自然，东方韵味 |
| Music Box | 音乐盒 | 柔和甜美，童话感 |

**功能特性**：
- ✅ **可开关**: 在设置中启用/禁用
- ✅ **单次播放**: 播放一次后自动停止
- ✅ **音频预览**: 在设置界面可以试听
- ✅ **预加载**: 提前加载，确保及时播放
- ✅ **触发时机**: 专注/休息计时结束时自动播放
- ✅ **不干扰**: 音量适中，不会打断思路

#### 3.3 长休息提醒音（Long Break Reminder）

**2 种优雅的提醒音**，在长休息前的最后一个专注阶段开始时播放：

| 音频 | 中文名 | 特点 |
|------|--------|------|
| None | 无声 | 关闭提醒音 |
| Bell | 摇铃 | 温柔提醒，不刺耳（默认） |
| Piano | 钢琴 | 优雅舒缓，音乐性强 |

**功能特性**：
- ✅ **可开关**: 在设置中启用/禁用
- ✅ **智能提醒**: 仅在长休息前的最后一个专注阶段开始时播放
- ✅ **音频预览**: 在设置界面可以试听
- ✅ **预加载**: 提前加载，确保及时播放
- ✅ **视觉提示**: 配合"下一个休息是长休息"的文字提示

#### 3.4 音频体验优化

**预加载机制**：
- 环境音在选择后立即预加载
- 完成提示音和提醒音在应用启动时预加载
- 减少播放延迟，确保及时响应

**错误处理**：
- 音频加载失败时显示友好的错误提示
- 提供"关闭"按钮，不影响其他功能使用
- 控制台输出详细错误信息，便于调试

**加载状态反馈**：
- 音频加载时显示"正在加载音频..."提示
- 加载完成后自动隐藏提示
- 用户体验流畅，不会感到卡顿

**音频文件管理**：
```
public/sounds/
├── ambient/          # 环境白噪音（8个文件）
│   ├── rain.ogg
│   ├── forest.ogg
│   ├── cafe.ogg
│   ├── fireplace.ogg
│   ├── ocean.ogg
│   ├── wind-chimes.ogg
│   ├── white-noise.ogg
│   └── library.ogg
├── completion/       # 完成提示音（3个文件）
│   ├── singing-bowl.ogg
│   ├── bamboo-chime.ogg
│   └── music-box.ogg
└── reminder/         # 长休息提醒音（2个文件）
    ├── bell.ogg
    └── piano.ogg
```

### 4. 数据统计与进度追踪

#### 4.1 每日统计
- 今日完成的专注次数
- 每日目标设置（默认 8 次）
- 目标完成提示

#### 4.2 历史数据
- 总专注次数（累计）
- 连续专注天数（Streak）
- 近 7 天进度图表

#### 4.3 数据可视化
- 柱状图展示每周进度
- 今日数据高亮显示
- 悬停显示详细数据
- 与每日目标对比

#### 4.4 数据持久化
- 使用 localStorage 存储
- 自动迁移旧数据格式
- 按日期记录历史数据

### 5. 用户体验优化

#### 5.1 键盘快捷键
- `Space`: 播放/暂停
- `→`: 跳过当前阶段
- 自动忽略输入框中的快捷键

#### 5.2 全屏模式
- 一键进入/退出全屏
- 沉浸式专注体验
- 图标状态同步

#### 5.3 响应式设计
- 适配桌面、平板、手机
- 移动端优化的控制布局
- 自适应字体和图标大小

#### 5.4 会话指示器
- 花朵图标显示当前轮次进度
- 已完成的会话高亮显示
- 实时更新

---

## 🛠️ 技术架构

### 技术栈
- **框架**: React 19.2.0 + TypeScript 5.8.2
- **构建工具**: Vite 6.2.0
- **样式**: Tailwind CSS (内联样式)
- **状态管理**: React Hooks (useState, useEffect, useRef, useCallback)
- **数据持久化**: localStorage

### 核心组件结构

```
App.tsx                    # 主应用组件，状态管理中心
├── TimerPanel.tsx         # 计时器面板（专注/休息显示）
├── Controls.tsx           # 控制栏（播放、音量、设置等）
├── SettingsModal.tsx      # 设置弹窗
├── InfoModal.tsx          # 信息/统计弹窗
├── CircularProgress.tsx   # 圆形进度条
└── Icons.tsx              # 图标组件库
```

### 状态管理
- **计时状态**: mode, timeLeft, isActive
- **配置状态**: focusDuration, breakDuration, longBreakDuration, sessionsPerRound
- **音频状态**: volume, selectedSound, completionSound, reminderSound
- **主题状态**: focusBgColor, focusTextColor, breakBgColor, etc.
- **统计状态**: dailySessionsCompleted, weeklyProgress, totalSessions, focusStreak

### 关键技术实现

#### 1. 音频淡入淡出
```typescript
fadeAudio(targetVolume, duration, onComplete)
```
- 平滑过渡音量，避免突兀
- 支持回调函数
- 50ms 步进更新

#### 2. 自动模式切换
```typescript
switchMode()
```
- 专注结束 → 更新统计 → 判断长/短休息
- 休息结束 → 返回专注 → 检查是否需要提醒

#### 3. 数据持久化
- 所有设置实时保存到 localStorage
- 历史数据按日期存储为 JSON
- 自动迁移旧数据格式

---

## 📊 用户界面详解

### 主界面布局

```
┌─────────────────────────────────────────┐
│                                    [i]  │  ← 信息按钮
│  ┌──────────────┬──────────────┐        │
│  │   FOCUS      │    BREAK     │        │  ← 分屏显示
│  │   [icon]     │   [icon]     │        │
│  │   25:00      │   05:00      │        │
│  └──────────────┴──────────────┘        │
│                                          │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │  ← 进度条
│  [▶] [🔊──] [00:00/25:00 ●●○○] [⚙][⏭][⛶] │  ← 控制栏
└─────────────────────────────────────────┘
```

### 设置界面

**计时器与目标**
- 专注时长 (1-120 分钟)
- 短休息时长 (1-60 分钟)
- 长休息时长 (1-60 分钟)
- 每轮会话数 (0-12)
- 每日目标 (0-24)

**音效设置**
- 环境音选择
- 完成提示音（可开关）
- 长休息提醒音（可开关）

**主题配色**
- 4 套预设主题
- 自定义 6 种颜色（专注/休息/长休息的背景和文字）

### 统计界面

**今日专注**
- 完成次数 / 目标次数
- 目标完成提示

**总体数据**
- 连续天数
- 总会话数

**每周进度**
- 7 天柱状图
- 今日高亮
- 悬停显示详情

**快捷键提示**
- Space: 播放/暂停
- →: 跳过会话

---

## 🎨 设计理念

### 视觉设计原则
1. **极简主义**: 去除一切不必要的元素
2. **柔和配色**: 使用低饱和度、高明度的颜色
3. **平滑过渡**: 所有状态变化都有动画
4. **呼吸感**: 活动状态下的微妙动画

### 交互设计原则
1. **非侵入性**: 不打断用户的专注状态
2. **渐进式**: 音频淡入淡出，避免突兀
3. **可预测**: 清晰的状态指示和反馈
4. **可访问性**: 支持键盘操作，ARIA 标签

### 音频设计原则
1. **环境音**: 循环播放，营造氛围
2. **提示音**: 短促清脆，不刺耳
3. **音量控制**: 用户完全掌控
4. **淡入淡出**: 避免突然的声音变化

---

## 💡 使用场景

### 场景 1: 学生备考
- 设置 25 分钟专注，5 分钟休息
- 每 4 个番茄钟后长休息 15 分钟
- 选择"Lofi Beat"或"Cafe"背景音
- 设置每日目标 8 次（约 4 小时纯学习时间）

### 场景 2: 深度工作
- 设置 50 分钟专注，10 分钟休息
- 禁用长休息（设为 0）
- 选择"Rain"或"Forest"背景音
- 全屏模式，减少干扰

### 场景 3: 轻度工作
- 设置 15 分钟专注，3 分钟休息
- 每 2 个番茄钟后长休息 10 分钟
- 选择"Wind Chimes"背景音
- 开启完成提示音

---

## 🚀 未来优化方向

### 功能增强
1. **任务管理**: 为每个番茄钟关联具体任务
2. **标签系统**: 按项目/科目分类统计
3. **云同步**: 跨设备数据同步
4. **更多统计**: 月度报告、年度总结
5. **自定义音频**: 支持用户上传音频文件

### 体验优化
1. **桌面通知**: 计时结束时的系统通知
2. **更多主题**: 增加季节主题、节日主题
3. **动画效果**: 更丰富的过渡动画
4. **多语言**: 支持英文、日文等
5. **暗黑模式**: 自动跟随系统设置

### 技术优化
1. **PWA**: 支持离线使用和安装
2. **性能优化**: 减少重渲染
3. **音频预加载**: 避免首次播放延迟
4. **数据导出**: 支持导出统计数据

---

## 📝 总结

FlowMind 是一款专注于用户体验的番茄钟应用，通过柔和的视觉设计、舒缓的音效和完善的统计功能，帮助用户建立良好的专注习惯。产品的核心优势在于：

✅ **极简设计** - 去除干扰，专注本质  
✅ **柔和体验** - 适合对刺激敏感的用户  
✅ **高度可定制** - 时长、音效、主题全可调  
✅ **数据追踪** - 可视化进度，激励坚持  
✅ **无缝体验** - 键盘快捷键、全屏模式、响应式设计  

产品适合所有需要提升专注力的用户，特别是学生、知识工作者和创意工作者。

